dist: xenial

language: python
python:
  - 3.5
  - 3.6
  - 3.7

before_install:
  - wget -q https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb
  - sudo dpkg -i packages-microsoft-prod.deb
  - sudo apt-get update
  - sudo apt-get install --no-install-recommends -y dotnet-sdk-3.0

install:
  - pip install -r requirements-test.txt

env:
  - RUN_CMD="flake8 . && pytest -v tests/ --cov=m2cgen/ --ignore=tests/e2e/ && coveralls"
  - RUN_CMD="python setup.py install && rm -rfd m2cgen/ && pytest -v -m 'c or python or java or go or javascript' tests/e2e/"
  - RUN_CMD="python setup.py install && rm -rfd m2cgen/ && pytest -v -m 'c_sharp or visual_basic' tests/e2e/"

script: "eval $RUN_CMD"
